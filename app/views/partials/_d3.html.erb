<style type="text/css">
#pieChart {    
  position:absolute;
  top:10px;
  left:10px;
  width:400px;
  height: 400px; 
}



#lineChart {    
  position:absolute;
  top:10px;
  left:410px;
  height: 150px;
}

#barChart {
  position:absolute;
  top:160px;
  left:410px;
  height: 250px;
}

.slice {
   font-size: 12pt;
   font-family: Verdana;
   fill: white; //svg specific - instead of color
   font-weight: bold;	
          } 
</style>

<div id='pieChart'></div>

<script type="text/javascript">
  var 	formatAsPercentage = d3.format("%"),
  formatAsPercentage1Dec = d3.format(".1%"),
  formatAsInteger = d3.format(","),
  fsec = d3.time.format("%S s"),
  fmin = d3.time.format("%M m"),
  fhou = d3.time.format("%H h"),
  fwee = d3.time.format("%a"),
  fdat = d3.time.format("%d d"),
  fmon = d3.time.format("%b")
  ;
  /* PIE CHART */
  
  function dsPieChart(){
    var dataset = [
      {category: "Sam", measure: 0.30},
      {category: "John", measure: 0.25},
      {category: "Rick", measure: 0.040},
      {category: "Paul", measure: 0.05}

    ];

    var width = 400,
        height = 400,
        outerRadius = Math.min(width,height) / 2,
        innerRadius = outerRadius * .999,
        // for animation
        innerRadiusFinal = outerRadius * 0.5,
        innerRadiusFinal3 = outerRadius * 0.45,
        color = d3.scale.category20() //built in range of colors
    ;

    var vis = d3.select("#pieChart")
          .append("svg:svg")
          .data([dataset])
            .attr("width",width)
            .attr("height",height)
            .append('svg:g')
              .attr("transform","translate("+ outerRadius + "," + outerRadius + ")") //movec enter of pie chart from 0,0 to radius,radius
            ;
    var arc = d3.svg.arc() // tihs will create <path> elements for us using arc data
              .outerRadius(outerRadius).innerRadius(innerRadius);
    
    // for animation
      var arcFinal = d3.svg.arc().innerRadius(innerRadiusFinal).outerRadius(outerRadius);
      var arcFinal3 = d3.svg.arc().innerRadius(innerRadiusFinal3).outerRadius(outerRadius);

      var pie = d3.layout.pie() //this will create arc data for us given a list of values
          .value(function(d){
            return d.measure;
          }); // we must tell it out to access the value of each element in our data array
      
      var arcs = vis.selectAll("g.slice") // selects all <g> elements with class slice (there aren't any yet)
            .data(pie)
            .enter()
            .append('svg:g')
              .attr("class","slice")
              .on("mouseover",mouseover)
            .on('mouseout',mouseout)
            .on("click",up)
            ;

            arcs.append("svg:path")
                  .attr("fill",function(d,i){
                    return color(i);
                  })
                  .attr("d",arc)
                .append("svg:title")
                  .text(function(d){return d.data.category + ': ' + formatAsPercentage(d.data.measure);});
              
              d3.selectAll('g.slice').selectAll('path').transition()
                  .duration(750)
                  .delay(10)
                  .attr("d",arcFinal)
                  ;
        
        // Add label to the larger arcs, translated to the arc centroid and rotated
        // source: http://bl.ocks.org/1305337#index.html
        
        arcs.filter(function(d){return d.endAngle - d.startAngle >.2;})
            .append('svg:text')
            .attr('dy','.35em')
            .attr('text-anchor','middle')
            .attr('transform', function(d){ return "translate(" + arcFinal.centroid(d) + ")rotate(" + angle(d) + ")"; })
            .text(function(d) {return d.data.category; })
            ;
        
        // Computes the label angle of an arc, converting from radians to degrees.
        function angle(d) {
          var a = (d.startAngle + d.endAngle) * 90 / Math.PI - 90;
          return a > 90 ? a - 180 : a;
        }
        
        // Pie chart title
        vis.append("svg:text")
          .attr("dy",".35em")
          .attr("text-anchor","middle")
          .text("Revenue Share 2012")
          .attr("class","title")
          ;
        
        function mouseover(){
          d3.select(this).select("path").transition()
            .duration(750)
              .attr("d",arcFinal)
              ;
        }

        function mouseout(){
          d3.select(this).select("path").transition()
            .duration(750)
            .attr("d",arcFinal);
        }

        function up(d,i) {
          //updateBarChart(d.data.category, color(i));
          //updateLineChart(d.data.category, color(i));
        }
        
      }
      dsPieChart();
</script>